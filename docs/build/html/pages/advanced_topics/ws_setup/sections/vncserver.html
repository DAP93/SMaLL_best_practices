<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>2. VNC Server &mdash; SMaLL best practice latest documentation</title>
      <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/togglebutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/mystnb.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/tabs.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" type="text/css" />
      <link rel="stylesheet" href="../../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script>
        <script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/underscore.js"></script>
        <script src="../../../../_static/doctools.js"></script>
        <script src="../../../../_static/togglebutton.js"></script>
        <script src="../../../../_static/clipboard.min.js"></script>
        <script src="../../../../_static/copybutton.js"></script>
        <script src="../../../../_static/tabs.js"></script>
        <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="High Performance Computing" href="../../hpc/index.html" />
    <link rel="prev" title="1. install Ubuntu" href="ubuntu.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html">
            <img src="../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../quick_start/index.html">Quick start</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Advanced topics</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Workststions set up</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ubuntu.html">1. install Ubuntu</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2. VNC Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#vnc-server-installation">2.1. VNC Server Installation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#install-desktop-environment-de">2.2. Install desktop environment (DE)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#set-up-vnc-session-for-each-user">2.3. Set up VNC session for each user</a></li>
<li class="toctree-l4"><a class="reference internal" href="#running-vnc-as-a-service-at-startup">2.4. Running VNC as a Service at startup</a></li>
<li class="toctree-l4"><a class="reference internal" href="#connect-to-the-vnc-server-through-ssh-tunnel">2.5. Connect to the VNC Server Through SSH Tunnel</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../hpc/index.html">High Performance Computing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../dft/index.html">Introduction to DFT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../how_to_contribute/index.html">How to contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/index.html">Tutorials</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">SMaLL best practice</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">Advanced topics</a> &raquo;</li>
          <li><a href="../index.html">Workststions set up</a> &raquo;</li>
      <li><span class="section-number">2. </span>VNC Server</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../../_sources/pages/advanced_topics/ws_setup/sections/vncserver.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="vnc-server">
<h1><span class="section-number">2. </span>VNC Server<a class="headerlink" href="#vnc-server" title="Permalink to this headline"></a></h1>
<p>Often there is a need to operate the workstation remotely but using various graphical user interfaces (GUIs).
As an alternative to <a class="reference external" href="hhttps://en.wikipedia.org/wiki/X.Org_Server">XServer</a> or commercial remote control programs
(e.g. TeamViewer, AnyDesk, etc.)
<a class="reference external" href="https://en.wikipedia.org/wiki/Virtual_Network_Computing">Virtual Network Computing (VNC)</a> is a viable alternative
that can often make life easier.
This guide shows you how to install on an Ubuntu system (20.04) the server (which is the machine you want to control)
and then use it with a client (RealVNC in this case) on any PC.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="../../../../_images/vnc-x.gif"><img alt="vnc" src="../../../../_images/vnc-x.gif" style="width: 50%;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.2 </span><span class="caption-text">A VNC server includes an X server that can communicate with local client programs.</span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Part of this Guide is an elaboration of the tutorials:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://developer.ibm.com/tutorials/os-multiuserloginsvnc">Enable multiuser logins with VNC</a></p></li>
<li><p><a class="reference external" href="https://linuxize.com/post/how-to-install-and-configure-vnc-on-ubuntu-20-04">How to Install and Configure VNC on Ubuntu 20.04</a></p></li>
</ol>
</div>
<div class="section" id="vnc-server-installation">
<h2><span class="section-number">2.1. </span>VNC Server Installation<a class="headerlink" href="#vnc-server-installation" title="Permalink to this headline"></a></h2>
<p>VNC is a cross-platform tool that can provide remote access to Linux, UNIX, Mac OS X, Windows and other
Operative Systems from any type of client.
On Linux there are several programs that allow your computer to become a VNC server,
in this guide we install one of the most used <a class="reference external" href="https://en.wikipedia.org/wiki/TightVNC">TightVNC</a>.</p>
<ol class="arabic">
<li><p>Update everithing</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo apt update <span class="o">&amp;&amp;</span> sudo apt upgrade
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Install the VNC server client TightVNC server</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo apt install tightvncserver tigervnc-standalone-server
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please make sure that you are using only vnc-server and no other VNC-server are installed as
this could give errors in future mostly that clipboard sharing between the host Ubuntu Server &amp; vnc-client machine.
You can check it as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ dpkg -l <span class="p">|</span> grep vnc
</pre></div>
</div>
</div>
</div>
<div class="section" id="install-desktop-environment-de">
<h2><span class="section-number">2.2. </span>Install desktop environment (DE)<a class="headerlink" href="#install-desktop-environment-de" title="Permalink to this headline"></a></h2>
<p>In addition to VNC, the <a class="reference external" href="https://en.wikipedia.org/wiki/Desktop_environment">desktop environment (DE)</a> must be installed, which is necessary to be able to reproduce
the entire interface and manage the GUIs of the applications.
In the linux mode there are several options, so it’s up to you.
Here we propose 3 possible options, from the simplest DE to the most aesthetic.</p>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">XFCE (fast)</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">GNOME (classic)</button><button aria-controls="panel-0-0-2" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-2" name="0-2" role="tab" tabindex="-1">Deepin DE (fancy)</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><p><a class="reference external" href="https://en.wikipedia.org/wiki/Xfce">XFCE</a> is probably the fastest and lightest, while being visually appealing and easy to use DE.</p>
<ol class="arabic">
<li><p>Install XFCE DE</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo apt install xfce4 xfce4-goodies
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><p><a class="reference external" href="https://en.wikipedia.org/wiki/GNOME">GNOME 3</a> is the default desktop environment on many major Linux
distributions including Fedora, Debian, Ubuntu, etc.</p>
<ol class="arabic">
<li><p>Install GNOME DE</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo apt install ubuntu-gnome-desktop
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div><div aria-labelledby="tab-0-0-2" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-2" name="0-2" role="tabpanel" tabindex="0"><p><a class="reference external" href="https://en.wikipedia.org/wiki/Deepin#Deepin_Desktop_Environment">Deepin DE</a> was described as <em>“the single most beautiful desktop on the market”</em>
by Jack Wallen writing for TechRepublic. We are going to use the <a class="reference external" href="https://ubuntudde.com/">Ubuntu Deepin DE</a> since
Ubuntu is the operating system of our workstation.</p>
<ol class="arabic">
<li><p>First add UbuntuDDE PPA</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo add-apt-repository ppa:ubuntudde-dev/stable
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Update the <cite>apt</cite> repository</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo apt update
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Install UbuntuDDE</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo apt install ubuntudde-dde
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
</div></div>
</div>
<div class="section" id="set-up-vnc-session-for-each-user">
<span id="vnc-set-up-vnc-session-for-each-user"></span><h2><span class="section-number">2.3. </span>Set up VNC session for each user<a class="headerlink" href="#set-up-vnc-session-for-each-user" title="Permalink to this headline"></a></h2>
<p>To avoid interference between different users, the server must be set up for each user.
We will assume that on our machine there are 3 users <cite>test1</cite>, <cite>test2</cite> and <cite>test3</cite>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Please note, you are accessing the machine as several users using super user permissions.
So be very careful and avoid doing any damage!</p>
</div>
<ol class="arabic">
<li><p>Login to <cite>test1</cite> using the root privilages.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo su <span class="c1"># loging as super user</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ su - test1 <span class="c1"># loging as test1</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Now initiate the vnc configuration for <cite>test1</cite>. This will create the hidden folder <cite>.vnc</cite> with all the default configuration files.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vncserver
</pre></div>
</div>
<p>You will be asked for the VNC server password – type your password. And for the “view-only” password,
you can enable or disable it. The user who logins to the server using the “view-only” password will
not be able to control the mouse and keyboard.</p>
<p>Now we kill the server that we just start:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vncserver -kill :*
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Change the configuration file.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> <span class="nv">$HOME</span>/.vnc
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vim xstartup
</pre></div>
</div>
<p>Inside the file copy and paste the following line, and chage the row 10 to set the choose Desktop Environment.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="ch">#!/bin/bash</span>
<span class="linenos"> 2</span><span class="nb">unset</span> SESSION_MANAGER
<span class="linenos"> 3</span><span class="nb">unset</span> DBUS_SESSION_BUS_ADDRESS
<span class="linenos"> 4</span><span class="nb">export</span> <span class="nv">XKL_XMODMAP_DISABLE</span><span class="o">=</span><span class="m">1</span>
<span class="linenos"> 5</span><span class="nb">export</span> <span class="nv">GTK_IM_MODULE</span><span class="o">=</span>fcitx
<span class="linenos"> 6</span><span class="nb">export</span> <span class="nv">QT_IM_MODULE</span><span class="o">=</span>fcitx
<span class="linenos"> 7</span><span class="nb">export</span> <span class="nv">XMODIFIERS</span><span class="o">=</span>@im<span class="o">=</span>fcitx
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1">#__using_dde__</span>
<span class="hll"><span class="linenos">10</span><span class="nv">session</span><span class="o">=</span>startxfce4 <span class="c1"># XFCE=startxfce4 GNOME=gnome-session DeepinDE=startdde</span>
</span><span class="linenos">11</span>
<span class="linenos">12</span><span class="c1">#__enable_clipboard_sync__</span>
<span class="linenos">13</span><span class="k">if</span> <span class="o">[</span> -f /usr/bin/autocutsel <span class="o">]</span>
<span class="linenos">14</span><span class="k">then</span>
<span class="linenos">15</span>    /usr/bin/autocutsel -fork
<span class="linenos">16</span><span class="k">fi</span>
<span class="linenos">17</span>
<span class="linenos">18</span><span class="c1">#__deepin_uos_activator__</span>
<span class="linenos">19</span><span class="k">if</span> <span class="o">[</span> -f /usr/bin/uos-activator <span class="o">]</span>
<span class="linenos">20</span><span class="k">then</span>
<span class="linenos">21</span>    /usr/bin/uos-activator <span class="p">&amp;</span>
<span class="linenos">22</span><span class="k">fi</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="c1">#__enable_fcitx__</span>
<span class="linenos">25</span><span class="k">if</span> <span class="o">[</span> -f /usr/bin/fcitx <span class="o">]</span>
<span class="linenos">26</span><span class="k">then</span>
<span class="linenos">27</span>    <span class="o">(</span>sleep <span class="m">15</span> <span class="o">&amp;&amp;</span> /usr/bin/fcitx<span class="o">)</span> <span class="p">&amp;</span>
<span class="linenos">28</span><span class="k">fi</span>
<span class="linenos">29</span>
<span class="linenos">30</span><span class="c1">#__kill_user_apps_duplicated__</span>
<span class="linenos">31</span>killall -9 v2ray <span class="p">&amp;</span>
<span class="linenos">32</span>
<span class="linenos">33</span><span class="nb">exec</span> dbus-launch <span class="nv">$session</span>
</pre></div>
</div>
<p>Make the file executable</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ chmod +x xstartup
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p><strong>Repeat all the step for all the users</strong> (eg. <cite>test2</cite>)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you what to chage the VNC server password you can use the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ vncpasswd
</pre></div>
</div>
</div>
</div>
<div class="section" id="running-vnc-as-a-service-at-startup">
<h2><span class="section-number">2.4. </span>Running VNC as a Service at startup<a class="headerlink" href="#running-vnc-as-a-service-at-startup" title="Permalink to this headline"></a></h2>
<p>With this step we will make crate a <cite>systemd service</cite> that will start the VNC server at each boot.
Even this step has to be repeated for each user.</p>
<ol class="arabic">
<li><p>Make the <cite>Unit</cite> file.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ <span class="nb">cd</span> /etc/systemd/system
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$ sudo vim vncserver_test1.service <span class="c1"># This is for the `test1` user</span>
</pre></div>
</div>
<p>copy and paste the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">[</span>Unit<span class="o">]</span>
<span class="linenos"> 2</span> <span class="nv">Description</span><span class="o">=</span>Remote desktop service <span class="o">(</span>VNC<span class="o">)</span>
<span class="linenos"> 3</span> <span class="nv">After</span><span class="o">=</span>syslog.target network.target
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="o">[</span>Service<span class="o">]</span>
<span class="linenos"> 6</span>  <span class="nv">Type</span><span class="o">=</span>forking
<span class="hll"><span class="linenos"> 7</span>  <span class="nv">User</span><span class="o">=</span>USER
</span><span class="hll"><span class="linenos"> 8</span>  <span class="nv">PIDFile</span><span class="o">=</span>/home/USER/.vnc/%H:PORT.pid
</span><span class="hll"><span class="linenos"> 9</span>  <span class="nv">ExecStartPre</span><span class="o">=</span>-/usr/bin/vncserver -kill :PORT &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</span><span class="hll"><span class="linenos">10</span>  <span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/vncserver -depth <span class="m">24</span> -geometry 1980x1080 :PORT
</span><span class="hll"><span class="linenos">11</span>  <span class="nv">ExecStop</span><span class="o">=</span>/usr/bin/vncserver -kill :PORT
</span><span class="linenos">12</span>
<span class="linenos">13</span><span class="o">[</span>Install<span class="o">]</span>
<span class="linenos">14</span>  <span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</pre></div>
</div>
<p>replace <cite>USER</cite> with the user name (eg. test1) and <cite>PORT</cite> with a sequential number.
Below an example:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="o">[</span>Unit<span class="o">]</span>
<span class="linenos"> 2</span> <span class="nv">Description</span><span class="o">=</span>Remote desktop service <span class="o">(</span>VNC<span class="o">)</span>
<span class="linenos"> 3</span> <span class="nv">After</span><span class="o">=</span>syslog.target network.target
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="o">[</span>Service<span class="o">]</span>
<span class="linenos"> 6</span>  <span class="nv">Type</span><span class="o">=</span>forking
<span class="hll"><span class="linenos"> 7</span>  <span class="nv">User</span><span class="o">=</span>test1
</span><span class="hll"><span class="linenos"> 8</span>  <span class="nv">PIDFile</span><span class="o">=</span>/home/test1/.vnc/%H:1.pid
</span><span class="hll"><span class="linenos"> 9</span>  <span class="nv">ExecStartPre</span><span class="o">=</span>-/usr/bin/vncserver -kill :1 &gt; /dev/null <span class="m">2</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</span><span class="hll"><span class="linenos">10</span>  <span class="nv">ExecStart</span><span class="o">=</span>/usr/bin/vncserver -depth <span class="m">24</span> -geometry 1980x1080 :1
</span><span class="hll"><span class="linenos">11</span>  <span class="nv">ExecStop</span><span class="o">=</span>/usr/bin/vncserver -kill :1
</span><span class="linenos">12</span>
<span class="linenos">13</span><span class="o">[</span>Install<span class="o">]</span>
<span class="linenos">14</span>  <span class="nv">WantedBy</span><span class="o">=</span>multi-user.target
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The number choose for <cite>PORT</cite> will correspond to the last number of the port where the VNC server will listening.
For example if <cite>PORT</cite> is 1, the VNC server will be listening on port 5901.</p>
</div>
</div></blockquote>
</li>
<li><p>Reload and start the service.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo systemctl daemon-reload
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo systemctl start vncserver_test1.service
</pre></div>
</div>
<p>Assuming everything goes error-free, add the service to the boot time and check the service status using systemctl.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo systemctl <span class="nb">enable</span> vncserver_test1.service
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo systemctl status vncserver_test1.service
</pre></div>
</div>
</div></blockquote>
</li>
</ol>
<p><strong>Repeat all the step for all the users</strong> (eg. <cite>test2</cite>)</p>
<p>Now the VNC server is set and it is listening for one port per each user,
you can restart the machine and check if the service start at the startup correctly.</p>
</div>
<div class="section" id="connect-to-the-vnc-server-through-ssh-tunnel">
<h2><span class="section-number">2.5. </span>Connect to the VNC Server Through SSH Tunnel<a class="headerlink" href="#connect-to-the-vnc-server-through-ssh-tunnel" title="Permalink to this headline"></a></h2>
<ol class="arabic">
<li><p>Open the SSH Tunnel.</p>
<blockquote>
<div><p>Open your terminal and type the ssh command as below</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh -L <span class="m">5901</span>:localhost:5901 -N -f test1@denerg33078.polito.it
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>With this command the port 5901 on local computer is connected with the 5901 of the server.
Note that we connect with the <cite>USER</cite> test1, therefore we connect the port 5901 since we set <cite>PORT</cite> as 1 in the
<cite>vncserver_test1.service</cite>.</p>
</div>
</div></blockquote>
</li>
<li><p>Download and install the VNC client, we are using <a class="reference external" href="https://www.realvnc.com/en/connect/download/viewer/">RealVNC Viewer</a>.</p></li>
<li><p>Set the defoult qulity to <cite>High</cite>.</p>
<blockquote>
<div><ol class="loweralpha">
<li><dl>
<dt>Open RealVNC Preferences <cite>File &gt; Preferences..</cite>.</dt><dd><div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../../../../_images/RealVNC_preference.png"><img alt="vnc" src="../../../../_images/RealVNC_preference.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.3 </span><span class="caption-text">RealVNC: Preference</span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</div>
</dd>
</dl>
</li>
</ol>
<p>#. Go to the <cite>Expert</cite> preference, scroll the list until you find the  <cite>Quality</cite> entry and change the values
from <cite>Auto</cite> to <cite>High</cite> (<cite>Expert &gt; Quality &gt; Value: High</cite>).</p>
<blockquote>
<div><div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../../../../_images/RealVNC_quality.png"><img alt="vnc" src="../../../../_images/RealVNC_quality.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.4 </span><span class="caption-text">RealVNC: Expert dialogue window</span><a class="headerlink" href="#id3" title="Permalink to this image"></a></p>
</div>
</div></blockquote>
<ol class="arabic simple">
<li><p>Click on the button <cite>OK</cite> and close the preferences window.</p></li>
</ol>
</div></blockquote>
</li>
<li><p>Connect to the VNC server.</p>
<blockquote>
<div><ol class="loweralpha">
<li><p>Type on the upper bar the andress and press <cite>ENTER</cite>.</p>
<blockquote>
<div><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>localhost:PORT
</pre></div>
</div>
<p>Where <cite>PORT</cite> is the user VNC server port, e.g for the user <cite>test1</cite> is <cite>5901</cite>, (therfore it will be <cite>localhost:5901</cite>)</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="../../../../_images/RealVNC_connecting.png"><img alt="vnc" src="../../../../_images/RealVNC_connecting.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.5 </span><span class="caption-text">RealVNC: Server andress</span><a class="headerlink" href="#id4" title="Permalink to this image"></a></p>
</div>
</div></blockquote>
</li>
<li><p>Type the VNC server password, that you set during the <a class="reference internal" href="#vnc-set-up-vnc-session-for-each-user"><span class="std std-ref">set up of the VNC session</span></a></p>
<blockquote>
<div><div class="figure align-center" id="id5">
<a class="reference internal image-reference" href="../../../../_images/RealVNC_connecting_authentication.png"><img alt="vnc" src="../../../../_images/RealVNC_connecting_authentication.png" style="width: 75%;" /></a>
<p class="caption"><span class="caption-number">Fig. 2.6 </span><span class="caption-text">RealVNC: Authentication pop-up</span><a class="headerlink" href="#id5" title="Permalink to this image"></a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>VNC will show a pop-up warning questioning the security of the connection.
This happens because it does not recognize that we are using SSH (Secure SHell) tunneling to connect the two computers.
Ignore it! The connection is secure because the SSH protocol encrypts all messages.</p>
</div>
</div></blockquote>
</li>
<li><p>ENJOY IT!</p>
<blockquote>
<div><div class="figure align-center">
<a class="reference internal image-reference" href="../../../../_images/RealVNC_connected.png"><img alt="vnc" src="../../../../_images/RealVNC_connected.png" style="width: 75%;" /></a>
</div>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</li>
</ol>
<div class="toctree-wrapper compound">
</div>
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ubuntu.html" class="btn btn-neutral float-left" title="1. install Ubuntu" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../hpc/index.html" class="btn btn-neutral float-right" title="High Performance Computing" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, Multi-Scale ModeLing Laboratory (SMaLL) POLITECNICO DI TORINO (Department of Energy &#34;Galileo Ferraris&#34; (DENERG)), ITA . All rights reserved.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>